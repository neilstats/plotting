{
  "hash": "e7d3bcef69e82958065ba0b80fc82062",
  "result": {
    "markdown": "---\ntitle: \"Adding columns of text to forest plots (but not every panel)\"\ndate: \"2022-12-07\"\nauthor: \"Neil Wright\"\nformat:\n  html:\n    toc: true\n---\n\n\n\n\n\nIn the `ckbplotr::forest_plot()` function the `col.left` and `col.right` arguments can be used to add columns of text to the plot - and they will add these columns for each panel in the plot.\n\n**But what if we want to add a column to only the left or right of all panels?**\n\nTo do this, set text we do not want plotted as missing and adjust the `mid.space` argument to remove unwanted extra space. For example...\n\nFirst create a plot without the additional column:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nforest_plot(panels            = list(resultsA, resultsB),\n            col.key           = \"variable\",\n            row.labels        = ckbplotr_row_labels,\n            row.labels.levels = c(\"heading\", \"subheading\", \"label\"),\n            rows              = c(\"Triglycerides concentration\",\n                                  \"Lipoprotein particle concentration\"),\n            exponentiate      = TRUE,\n            panel.headings    = c(\"Analysis A\", \"Analysis B\"),\n            ci.delim          = \" - \",\n            xlim              = c(0.9, 1.1),\n            xticks            = c(0.9, 1, 1.1),\n            blankrows         = c(1, 1, 0, 1),\n            scalepoints       = TRUE,\n            pointsize         = 3,\n            col.heading.space = 1.5)\n```\n\n::: {.cell-output-display}\n![](forest-plot-column_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nNote the automatically calculated value for `left.space` is `unit(2.9, \"mm\")`, and for `right.space` is `unit(25.5, \"mm\")`. (These are shown in the RStudio Viewer pane.)\n\nNow create the plot with the additional column `n` using `col.left` (or `col.right` as applicable).\n\n::: {.cell}\n\n```{.r .cell-code}\nforest_plot(panels            = list(resultsA, resultsB),\n            col.key           = \"variable\",\n            row.labels        = ckbplotr_row_labels,\n            row.labels.levels = c(\"heading\", \"subheading\", \"label\"),\n            rows              = c(\"Triglycerides concentration\",\n                                  \"Lipoprotein particle concentration\"),\n            exponentiate      = TRUE,\n            panel.headings    = c(\"Analysis A\", \"Analysis B\"),\n            ci.delim          = \" - \",\n            xlim              = c(0.9, 1.1),\n            xticks            = c(0.9, 1, 1.1),\n            blankrows         = c(1, 1, 0, 1),\n            scalepoints       = TRUE,\n            pointsize         = 3,\n            col.heading.space = 1.5,\n            \n            col.left          = \"n\",\n            col.left.heading  = \"No. of\\nevents\")\n```\n\n::: {.cell-output-display}\n![](forest-plot-column_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nNote that the automatically calculated `col.left` is now `unit(12.9, \"mm\")`. That is, there is now 10mm more space to the left of each panel for the added column of text.\n\nTo remove the column for the second panel, set the text to be plotted as missing and use a list for `col.left.heading` so that the heading is missing for the second panel.\n\n::: {.cell}\n\n```{.r .cell-code}\nresultsB$n <- NA\n\nforest_plot(panels            = list(resultsA, resultsB),\n            col.key           = \"variable\",\n            row.labels        = ckbplotr_row_labels,\n            row.labels.levels = c(\"heading\", \"subheading\", \"label\"),\n            rows              = c(\"Triglycerides concentration\",\n                                  \"Lipoprotein particle concentration\"),\n            exponentiate      = TRUE,\n            panel.headings    = c(\"Analysis A\", \"Analysis B\"),\n            ci.delim          = \" - \",\n            xlim              = c(0.9, 1.1),\n            xticks            = c(0.9, 1, 1.1),\n            blankrows         = c(1, 1, 0, 1),\n            scalepoints       = TRUE,\n            pointsize         = 3,\n            col.heading.space = 1.5,\n            \n            col.left          = \"n\",\n            col.left.heading  = list(\"No. of\\nevents\", NA))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing missing values (`geom_text_move()`).\n```\n:::\n\n::: {.cell-output-display}\n![](forest-plot-column_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nTo remove the extra 10mm of space between the panels, we subtract this from `mid.space` (which by default is 5mm):\n\n::: {.cell}\n\n```{.r .cell-code}\nforest_plot(panels            = list(resultsA, resultsB),\n            col.key           = \"variable\",\n            row.labels        = ckbplotr_row_labels,\n            row.labels.levels = c(\"heading\", \"subheading\", \"label\"),\n            rows              = c(\"Triglycerides concentration\",\n                                  \"Lipoprotein particle concentration\"),\n            exponentiate      = TRUE,\n            panel.headings    = c(\"Analysis A\", \"Analysis B\"),\n            ci.delim          = \" - \",\n            xlim              = c(0.9, 1.1),\n            xticks            = c(0.9, 1, 1.1),\n            blankrows         = c(1, 1, 0, 1),\n            scalepoints       = TRUE,\n            pointsize         = 3,\n            col.heading.space = 1.5,\n            \n            col.left          = \"n\",\n            col.left.heading  = list(\"No. of\\nevents\", NA),\n            mid.space         = unit(5, \"mm\") - unit(10, \"mm\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing missing values (`geom_text_move()`).\n```\n:::\n\n::: {.cell-output-display}\n![](forest-plot-column_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nTo do something similar for a column (`nb`) on the right on the plot:\n\n::: {.cell}\n\n```{.r .cell-code}\nresultsA$nb <- NA\n\nforest_plot(panels            = list(resultsA, resultsB),\n            col.key           = \"variable\",\n            row.labels        = ckbplotr_row_labels,\n            row.labels.levels = c(\"heading\", \"subheading\", \"label\"),\n            rows              = c(\"Triglycerides concentration\",\n                                  \"Lipoprotein particle concentration\"),\n            exponentiate      = TRUE,\n            panel.headings    = c(\"Analysis A\", \"Analysis B\"),\n            ci.delim          = \" - \",\n            xlim              = c(0.9, 1.1),\n            xticks            = c(0.9, 1, 1.1),\n            blankrows         = c(1, 1, 0, 1),\n            scalepoints       = TRUE,\n            pointsize         = 3,\n            col.heading.space = 1.5,\n            \n            col.right         = \"nb\",\n            col.right.heading = list(c(\"HR (95% CI)\", NA),\n                                     c(\"HR (95% CI)\", \"No. of\\nevents\")),\n            mid.space         = unit(5, \"mm\") - unit(12.1, \"mm\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing missing values (`geom_text_move()`).\n```\n:::\n\n::: {.cell-output-display}\n![](forest-plot-column_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "forest-plot-column_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}